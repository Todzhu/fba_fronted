<svg width="64" height="64" viewBox="0 0 64 64" xmlns="http://www.w3.org/2000/svg">
  <!-- Background -->
  <rect width="64" height="64" fill="#fefefe" rx="8"/>
  <rect x="6" y="6" width="52" height="52" fill="#f8fafc" stroke="#e2e8f0" stroke-width="1" rx="4"/>
  
  <!-- Before correction (left side) -->
  <rect x="10" y="12" width="20" height="20" fill="#fef2f2" stroke="#fecaca" stroke-width="1" rx="2"/>
  <text x="20" y="10" text-anchor="middle" font-family="Arial, sans-serif" font-size="5" fill="#dc2626" font-weight="bold">Before</text>
  
  <!-- Batch 1 (scattered, biased) -->
  <circle cx="14" cy="16" r="1.5" fill="#ef4444" opacity="0.8"/>
  <circle cx="16" cy="18" r="1.5" fill="#ef4444" opacity="0.8"/>
  <circle cx="18" cy="16" r="1.5" fill="#ef4444" opacity="0.8"/>
  <circle cx="15" cy="20" r="1.5" fill="#ef4444" opacity="0.8"/>
  <circle cx="17" cy="22" r="1.5" fill="#ef4444" opacity="0.8"/>
  
  <!-- Batch 2 (scattered, biased differently) -->
  <circle cx="22" cy="26" r="1.5" fill="#3b82f6" opacity="0.8"/>
  <circle cx="24" cy="28" r="1.5" fill="#3b82f6" opacity="0.8"/>
  <circle cx="26" cy="26" r="1.5" fill="#3b82f6" opacity="0.8"/>
  <circle cx="23" cy="30" r="1.5" fill="#3b82f6" opacity="0.8"/>
  <circle cx="25" cy="24" r="1.5" fill="#3b82f6" opacity="0.8"/>
  
  <!-- Arrow indicating correction -->
  <path d="M 32 22 L 38 22" stroke="#10b981" stroke-width="2" marker-end="url(#arrowhead)"/>
  <text x="35" y="20" text-anchor="middle" font-family="Arial, sans-serif" font-size="4" fill="#10b981" font-weight="bold">Correct</text>
  
  <!-- Arrow marker definition -->
  <defs>
    <marker id="arrowhead" markerWidth="6" markerHeight="4" refX="6" refY="2" orient="auto">
      <polygon points="0 0, 6 2, 0 4" fill="#10b981"/>
    </marker>
  </defs>
  
  <!-- After correction (right side) -->
  <rect x="40" y="12" width="16" height="20" fill="#f0fdf4" stroke="#bbf7d0" stroke-width="1" rx="2"/>
  <text x="48" y="10" text-anchor="middle" font-family="Arial, sans-serif" font-size="5" fill="#16a34a" font-weight="bold">After</text>
  
  <!-- Batch 1 (corrected, aligned) -->
  <circle cx="44" cy="20" r="1.5" fill="#ef4444" opacity="0.8"/>
  <circle cx="46" cy="22" r="1.5" fill="#ef4444" opacity="0.8"/>
  <circle cx="48" cy="20" r="1.5" fill="#ef4444" opacity="0.8"/>
  <circle cx="45" cy="24" r="1.5" fill="#ef4444" opacity="0.8"/>
  <circle cx="47" cy="18" r="1.5" fill="#ef4444" opacity="0.8"/>
  
  <!-- Batch 2 (corrected, aligned) -->
  <circle cx="50" cy="22" r="1.5" fill="#3b82f6" opacity="0.8"/>
  <circle cx="52" cy="20" r="1.5" fill="#3b82f6" opacity="0.8"/>
  <circle cx="54" cy="24" r="1.5" fill="#3b82f6" opacity="0.8"/>
  <circle cx="51" cy="18" r="1.5" fill="#3b82f6" opacity="0.8"/>
  <circle cx="53" cy="26" r="1.5" fill="#3b82f6" opacity="0.8"/>
  
  <!-- Statistical indicators -->
  <rect x="10" y="36" width="44" height="16" fill="#f8fafc" stroke="#e2e8f0" stroke-width="1" rx="2"/>
  
  <!-- Before stats -->
  <text x="12" y="40" font-family="Arial, sans-serif" font-size="5" fill="#dc2626" font-weight="bold">Before:</text>
  <text x="12" y="44" font-family="Arial, sans-serif" font-size="4" fill="#64748b">Batch variance: High</text>
  <text x="12" y="47" font-family="Arial, sans-serif" font-size="4" fill="#64748b">p-value: 0.001</text>
  
  <!-- After stats -->
  <text x="32" y="40" font-family="Arial, sans-serif" font-size="5" fill="#16a34a" font-weight="bold">After:</text>
  <text x="32" y="44" font-family="Arial, sans-serif" font-size="4" fill="#64748b">Batch variance: Low</text>
  <text x="32" y="47" font-family="Arial, sans-serif" font-size="4" fill="#64748b">p-value: 0.85</text>
  
  <!-- Method indicator -->
  <text x="32" y="51" text-anchor="middle" font-family="Arial, sans-serif" font-size="4" fill="#8b5cf6" font-weight="bold">ComBat / Harmony</text>
  
  <!-- Title -->
  <text x="32" y="8" text-anchor="middle" font-family="Arial, sans-serif" font-size="7" font-weight="bold" fill="#475569">Batch Correction</text>
</svg>